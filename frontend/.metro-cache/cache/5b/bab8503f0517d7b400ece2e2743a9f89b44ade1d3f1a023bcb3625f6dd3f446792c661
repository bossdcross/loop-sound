{"dependencies":[{"name":"./number-utils.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":29,"column":49,"index":987},"end":{"line":29,"column":77,"index":1015}}],"key":"ojgdc6cad54vZpRbS1wmL5i91MA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var __webpack_require__ = {};\n  (() => {\n    __webpack_require__.d = (exports1, definition) => {\n      for (var key in definition) if (__webpack_require__.o(definition, key) && !__webpack_require__.o(exports1, key)) Object.defineProperty(exports1, key, {\n        enumerable: true,\n        get: definition[key]\n      });\n    };\n  })();\n  (() => {\n    __webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\n  })();\n  (() => {\n    __webpack_require__.r = exports1 => {\n      if ('undefined' != typeof Symbol && Symbol.toStringTag) Object.defineProperty(exports1, Symbol.toStringTag, {\n        value: 'Module'\n      });\n      Object.defineProperty(exports1, '__esModule', {\n        value: true\n      });\n    };\n  })();\n  var __webpack_exports__ = {};\n  __webpack_require__.r(__webpack_exports__);\n  __webpack_require__.d(__webpack_exports__, {\n    BucketedRateLimiter: () => BucketedRateLimiter\n  });\n  const external_number_utils_js_namespaceObject = require(_dependencyMap[0], \"./number-utils.js\");\n  const ONE_DAY_IN_MS = 86400000;\n  class BucketedRateLimiter {\n    constructor(options) {\n      this._buckets = {};\n      this._onBucketRateLimited = options._onBucketRateLimited;\n      this._bucketSize = (0, external_number_utils_js_namespaceObject.clampToRange)(options.bucketSize, 0, 100, options._logger);\n      this._refillRate = (0, external_number_utils_js_namespaceObject.clampToRange)(options.refillRate, 0, this._bucketSize, options._logger);\n      this._refillInterval = (0, external_number_utils_js_namespaceObject.clampToRange)(options.refillInterval, 0, ONE_DAY_IN_MS, options._logger);\n    }\n    _applyRefill(bucket, now) {\n      const elapsedMs = now - bucket.lastAccess;\n      const refillIntervals = Math.floor(elapsedMs / this._refillInterval);\n      if (refillIntervals > 0) {\n        const tokensToAdd = refillIntervals * this._refillRate;\n        bucket.tokens = Math.min(bucket.tokens + tokensToAdd, this._bucketSize);\n        bucket.lastAccess = bucket.lastAccess + refillIntervals * this._refillInterval;\n      }\n    }\n    consumeRateLimit(key) {\n      const now = Date.now();\n      const keyStr = String(key);\n      let bucket = this._buckets[keyStr];\n      if (bucket) this._applyRefill(bucket, now);else {\n        bucket = {\n          tokens: this._bucketSize,\n          lastAccess: now\n        };\n        this._buckets[keyStr] = bucket;\n      }\n      if (0 === bucket.tokens) return true;\n      bucket.tokens--;\n      if (0 === bucket.tokens) this._onBucketRateLimited?.(key);\n      return 0 === bucket.tokens;\n    }\n    stop() {\n      this._buckets = {};\n    }\n  }\n  exports.BucketedRateLimiter = __webpack_exports__.BucketedRateLimiter;\n  for (var __webpack_i__ in __webpack_exports__) if (-1 === [\"BucketedRateLimiter\"].indexOf(__webpack_i__)) exports[__webpack_i__] = __webpack_exports__[__webpack_i__];\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n});","lineCount":75,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0],[4,6,2,4,"__webpack_require__"],[4,25,2,23],[4,28,2,26],[4,29,2,27],[4,30,2,28],[5,2,3,0],[5,3,3,1],[5,9,3,5],[6,4,4,4,"__webpack_require__"],[6,23,4,23],[6,24,4,24,"d"],[6,25,4,25],[6,28,4,28],[6,29,4,29,"exports1"],[6,37,4,37],[6,39,4,39,"definition"],[6,49,4,49],[6,54,4,52],[7,6,5,8],[7,11,5,12],[7,15,5,16,"key"],[7,18,5,19],[7,22,5,23,"definition"],[7,32,5,33],[7,34,5,34],[7,38,5,38,"__webpack_require__"],[7,57,5,57],[7,58,5,58,"o"],[7,59,5,59],[7,60,5,60,"definition"],[7,70,5,70],[7,72,5,72,"key"],[7,75,5,75],[7,76,5,76],[7,80,5,80],[7,81,5,81,"__webpack_require__"],[7,100,5,100],[7,101,5,101,"o"],[7,102,5,102],[7,103,5,103,"exports1"],[7,111,5,111],[7,113,5,113,"key"],[7,116,5,116],[7,117,5,117],[7,119,5,119,"Object"],[7,125,5,125],[7,126,5,126,"defineProperty"],[7,140,5,140],[7,141,5,141,"exports1"],[7,149,5,149],[7,151,5,151,"key"],[7,154,5,154],[7,156,5,156],[8,8,6,12,"enumerable"],[8,18,6,22],[8,20,6,24],[8,24,6,28],[9,8,7,12,"get"],[9,11,7,15],[9,13,7,17,"definition"],[9,23,7,27],[9,24,7,28,"key"],[9,27,7,31],[10,6,8,8],[10,7,8,9],[10,8,8,10],[11,4,9,4],[11,5,9,5],[12,2,10,0],[12,3,10,1],[12,5,10,3],[12,6,10,4],[13,2,11,0],[13,3,11,1],[13,9,11,5],[14,4,12,4,"__webpack_require__"],[14,23,12,23],[14,24,12,24,"o"],[14,25,12,25],[14,28,12,28],[14,29,12,29,"obj"],[14,32,12,32],[14,34,12,34,"prop"],[14,38,12,38],[14,43,12,41,"Object"],[14,49,12,47],[14,50,12,48,"prototype"],[14,59,12,57],[14,60,12,58,"hasOwnProperty"],[14,74,12,72],[14,75,12,73,"call"],[14,79,12,77],[14,80,12,78,"obj"],[14,83,12,81],[14,85,12,83,"prop"],[14,89,12,87],[14,90,12,88],[15,2,13,0],[15,3,13,1],[15,5,13,3],[15,6,13,4],[16,2,14,0],[16,3,14,1],[16,9,14,5],[17,4,15,4,"__webpack_require__"],[17,23,15,23],[17,24,15,24,"r"],[17,25,15,25],[17,28,15,29,"exports1"],[17,36,15,37],[17,40,15,40],[18,6,16,8],[18,10,16,12],[18,21,16,23],[18,25,16,27],[18,32,16,34,"Symbol"],[18,38,16,40],[18,42,16,44,"Symbol"],[18,48,16,50],[18,49,16,51,"toStringTag"],[18,60,16,62],[18,62,16,64,"Object"],[18,68,16,70],[18,69,16,71,"defineProperty"],[18,83,16,85],[18,84,16,86,"exports1"],[18,92,16,94],[18,94,16,96,"Symbol"],[18,100,16,102],[18,101,16,103,"toStringTag"],[18,112,16,114],[18,114,16,116],[19,8,17,12,"value"],[19,13,17,17],[19,15,17,19],[20,6,18,8],[20,7,18,9],[20,8,18,10],[21,6,19,8,"Object"],[21,12,19,14],[21,13,19,15,"defineProperty"],[21,27,19,29],[21,28,19,30,"exports1"],[21,36,19,38],[21,38,19,40],[21,50,19,52],[21,52,19,54],[22,8,20,12,"value"],[22,13,20,17],[22,15,20,19],[23,6,21,8],[23,7,21,9],[23,8,21,10],[24,4,22,4],[24,5,22,5],[25,2,23,0],[25,3,23,1],[25,5,23,3],[25,6,23,4],[26,2,24,0],[26,6,24,4,"__webpack_exports__"],[26,25,24,23],[26,28,24,26],[26,29,24,27],[26,30,24,28],[27,2,25,0,"__webpack_require__"],[27,21,25,19],[27,22,25,20,"r"],[27,23,25,21],[27,24,25,22,"__webpack_exports__"],[27,43,25,41],[27,44,25,42],[28,2,26,0,"__webpack_require__"],[28,21,26,19],[28,22,26,20,"d"],[28,23,26,21],[28,24,26,22,"__webpack_exports__"],[28,43,26,41],[28,45,26,43],[29,4,27,4,"BucketedRateLimiter"],[29,23,27,23],[29,25,27,25,"BucketedRateLimiter"],[29,26,27,25],[29,31,27,29,"BucketedRateLimiter"],[30,2,28,0],[30,3,28,1],[30,4,28,2],[31,2,29,0],[31,8,29,6,"external_number_utils_js_namespaceObject"],[31,48,29,46],[31,51,29,49,"require"],[31,58,29,56],[31,59,29,56,"_dependencyMap"],[31,73,29,56],[31,97,29,76],[31,98,29,77],[32,2,30,0],[32,8,30,6,"ONE_DAY_IN_MS"],[32,21,30,19],[32,24,30,22],[32,32,30,30],[33,2,31,0],[33,8,31,6,"BucketedRateLimiter"],[33,27,31,25],[33,28,31,26],[34,4,32,4,"constructor"],[34,15,32,15,"constructor"],[34,16,32,16,"options"],[34,23,32,23],[34,25,32,24],[35,6,33,8],[35,10,33,12],[35,11,33,13,"_buckets"],[35,19,33,21],[35,22,33,24],[35,23,33,25],[35,24,33,26],[36,6,34,8],[36,10,34,12],[36,11,34,13,"_onBucketRateLimited"],[36,31,34,33],[36,34,34,36,"options"],[36,41,34,43],[36,42,34,44,"_onBucketRateLimited"],[36,62,34,64],[37,6,35,8],[37,10,35,12],[37,11,35,13,"_bucketSize"],[37,22,35,24],[37,25,35,27],[37,26,35,28],[37,27,35,29],[37,29,35,31,"external_number_utils_js_namespaceObject"],[37,69,35,71],[37,70,35,72,"clampToRange"],[37,82,35,84],[37,84,35,86,"options"],[37,91,35,93],[37,92,35,94,"bucketSize"],[37,102,35,104],[37,104,35,106],[37,105,35,107],[37,107,35,109],[37,110,35,112],[37,112,35,114,"options"],[37,119,35,121],[37,120,35,122,"_logger"],[37,127,35,129],[37,128,35,130],[38,6,36,8],[38,10,36,12],[38,11,36,13,"_refillRate"],[38,22,36,24],[38,25,36,27],[38,26,36,28],[38,27,36,29],[38,29,36,31,"external_number_utils_js_namespaceObject"],[38,69,36,71],[38,70,36,72,"clampToRange"],[38,82,36,84],[38,84,36,86,"options"],[38,91,36,93],[38,92,36,94,"refillRate"],[38,102,36,104],[38,104,36,106],[38,105,36,107],[38,107,36,109],[38,111,36,113],[38,112,36,114,"_bucketSize"],[38,123,36,125],[38,125,36,127,"options"],[38,132,36,134],[38,133,36,135,"_logger"],[38,140,36,142],[38,141,36,143],[39,6,37,8],[39,10,37,12],[39,11,37,13,"_refillInterval"],[39,26,37,28],[39,29,37,31],[39,30,37,32],[39,31,37,33],[39,33,37,35,"external_number_utils_js_namespaceObject"],[39,73,37,75],[39,74,37,76,"clampToRange"],[39,86,37,88],[39,88,37,90,"options"],[39,95,37,97],[39,96,37,98,"refillInterval"],[39,110,37,112],[39,112,37,114],[39,113,37,115],[39,115,37,117,"ONE_DAY_IN_MS"],[39,128,37,130],[39,130,37,132,"options"],[39,137,37,139],[39,138,37,140,"_logger"],[39,145,37,147],[39,146,37,148],[40,4,38,4],[41,4,39,4,"_applyRefill"],[41,16,39,16,"_applyRefill"],[41,17,39,17,"bucket"],[41,23,39,23],[41,25,39,25,"now"],[41,28,39,28],[41,30,39,30],[42,6,40,8],[42,12,40,14,"elapsedMs"],[42,21,40,23],[42,24,40,26,"now"],[42,27,40,29],[42,30,40,32,"bucket"],[42,36,40,38],[42,37,40,39,"lastAccess"],[42,47,40,49],[43,6,41,8],[43,12,41,14,"refillIntervals"],[43,27,41,29],[43,30,41,32,"Math"],[43,34,41,36],[43,35,41,37,"floor"],[43,40,41,42],[43,41,41,43,"elapsedMs"],[43,50,41,52],[43,53,41,55],[43,57,41,59],[43,58,41,60,"_refillInterval"],[43,73,41,75],[43,74,41,76],[44,6,42,8],[44,10,42,12,"refillIntervals"],[44,25,42,27],[44,28,42,30],[44,29,42,31],[44,31,42,33],[45,8,43,12],[45,14,43,18,"tokensToAdd"],[45,25,43,29],[45,28,43,32,"refillIntervals"],[45,43,43,47],[45,46,43,50],[45,50,43,54],[45,51,43,55,"_refillRate"],[45,62,43,66],[46,8,44,12,"bucket"],[46,14,44,18],[46,15,44,19,"tokens"],[46,21,44,25],[46,24,44,28,"Math"],[46,28,44,32],[46,29,44,33,"min"],[46,32,44,36],[46,33,44,37,"bucket"],[46,39,44,43],[46,40,44,44,"tokens"],[46,46,44,50],[46,49,44,53,"tokensToAdd"],[46,60,44,64],[46,62,44,66],[46,66,44,70],[46,67,44,71,"_bucketSize"],[46,78,44,82],[46,79,44,83],[47,8,45,12,"bucket"],[47,14,45,18],[47,15,45,19,"lastAccess"],[47,25,45,29],[47,28,45,32,"bucket"],[47,34,45,38],[47,35,45,39,"lastAccess"],[47,45,45,49],[47,48,45,52,"refillIntervals"],[47,63,45,67],[47,66,45,70],[47,70,45,74],[47,71,45,75,"_refillInterval"],[47,86,45,90],[48,6,46,8],[49,4,47,4],[50,4,48,4,"consumeRateLimit"],[50,20,48,20,"consumeRateLimit"],[50,21,48,21,"key"],[50,24,48,24],[50,26,48,26],[51,6,49,8],[51,12,49,14,"now"],[51,15,49,17],[51,18,49,20,"Date"],[51,22,49,24],[51,23,49,25,"now"],[51,26,49,28],[51,27,49,29],[51,28,49,30],[52,6,50,8],[52,12,50,14,"keyStr"],[52,18,50,20],[52,21,50,23,"String"],[52,27,50,29],[52,28,50,30,"key"],[52,31,50,33],[52,32,50,34],[53,6,51,8],[53,10,51,12,"bucket"],[53,16,51,18],[53,19,51,21],[53,23,51,25],[53,24,51,26,"_buckets"],[53,32,51,34],[53,33,51,35,"keyStr"],[53,39,51,41],[53,40,51,42],[54,6,52,8],[54,10,52,12,"bucket"],[54,16,52,18],[54,18,52,20],[54,22,52,24],[54,23,52,25,"_applyRefill"],[54,35,52,37],[54,36,52,38,"bucket"],[54,42,52,44],[54,44,52,46,"now"],[54,47,52,49],[54,48,52,50],[54,49,52,51],[54,54,53,13],[55,8,54,12,"bucket"],[55,14,54,18],[55,17,54,21],[56,10,55,16,"tokens"],[56,16,55,22],[56,18,55,24],[56,22,55,28],[56,23,55,29,"_bucketSize"],[56,34,55,40],[57,10,56,16,"lastAccess"],[57,20,56,26],[57,22,56,28,"now"],[58,8,57,12],[58,9,57,13],[59,8,58,12],[59,12,58,16],[59,13,58,17,"_buckets"],[59,21,58,25],[59,22,58,26,"keyStr"],[59,28,58,32],[59,29,58,33],[59,32,58,36,"bucket"],[59,38,58,42],[60,6,59,8],[61,6,60,8],[61,10,60,12],[61,11,60,13],[61,16,60,18,"bucket"],[61,22,60,24],[61,23,60,25,"tokens"],[61,29,60,31],[61,31,60,33],[61,38,60,40],[61,42,60,44],[62,6,61,8,"bucket"],[62,12,61,14],[62,13,61,15,"tokens"],[62,19,61,21],[62,21,61,23],[63,6,62,8],[63,10,62,12],[63,11,62,13],[63,16,62,18,"bucket"],[63,22,62,24],[63,23,62,25,"tokens"],[63,29,62,31],[63,31,62,33],[63,35,62,37],[63,36,62,38,"_onBucketRateLimited"],[63,56,62,58],[63,59,62,61,"key"],[63,62,62,64],[63,63,62,65],[64,6,63,8],[64,13,63,15],[64,14,63,16],[64,19,63,21,"bucket"],[64,25,63,27],[64,26,63,28,"tokens"],[64,32,63,34],[65,4,64,4],[66,4,65,4,"stop"],[66,8,65,8,"stop"],[66,9,65,8],[66,11,65,11],[67,6,66,8],[67,10,66,12],[67,11,66,13,"_buckets"],[67,19,66,21],[67,22,66,24],[67,23,66,25],[67,24,66,26],[68,4,67,4],[69,2,68,0],[70,2,69,0,"exports"],[70,9,69,7],[70,10,69,8,"BucketedRateLimiter"],[70,29,69,27],[70,32,69,30,"__webpack_exports__"],[70,51,69,49],[70,52,69,50,"BucketedRateLimiter"],[70,71,69,69],[71,2,70,0],[71,7,70,4],[71,11,70,8,"__webpack_i__"],[71,24,70,21],[71,28,70,25,"__webpack_exports__"],[71,47,70,44],[71,49,70,45],[71,53,70,49],[71,54,70,50],[71,55,70,51],[71,60,70,56],[71,61,71,4],[71,82,71,25],[71,83,72,1],[71,84,72,2,"indexOf"],[71,91,72,9],[71,92,72,10,"__webpack_i__"],[71,105,72,23],[71,106,72,24],[71,108,72,26,"exports"],[71,115,72,33],[71,116,72,34,"__webpack_i__"],[71,129,72,47],[71,130,72,48],[71,133,72,51,"__webpack_exports__"],[71,152,72,70],[71,153,72,71,"__webpack_i__"],[71,166,72,84],[71,167,72,85],[72,2,73,0,"Object"],[72,8,73,6],[72,9,73,7,"defineProperty"],[72,23,73,21],[72,24,73,22,"exports"],[72,31,73,29],[72,33,73,31],[72,45,73,43],[72,47,73,45],[73,4,74,4,"value"],[73,9,74,9],[73,11,74,11],[74,2,75,0],[74,3,75,1],[74,4,75,2],[75,0,75,3],[75,3]],"functionMap":{"names":["<global>","<anonymous>","__webpack_require__.d","__webpack_require__.o","__webpack_require__.r","__webpack_require__.d$argument_1.BucketedRateLimiter","BucketedRateLimiter","BucketedRateLimiter#constructor","BucketedRateLimiter#_applyRefill","BucketedRateLimiter#consumeRateLimit","BucketedRateLimiter#stop"],"mappings":"AAA;CCE;4BCC;KDK;CDC;CCC;4BEC,4DF;CDC;CCC;4BGC;KHO;CDC;yBKI,uBL;AMI;ICC;KDM;IEC;KFQ;IGC;KHgB;IIC;KJE;CNC"},"hasCjsExports":true},"type":"js/module"}]}